---
title: RSI指标策略
date: 2023-06-15 10:56:39
permalink: /pages/4c721e/
categories:
  - 策略
tags:
  - 
author: 
  name: Mcanjia
  link: https://github.com/mcjisok
---

## RSI指标是什么

RSI指标，全称`Relative Strength Index`，中文名为相对强弱指标，简称为RSI。它由知名技术分析家`Welles Wilder`于1978年创造，并已成为与MACD和KD齐名的三大常用技术指标之一。

RSI是一种动量分析方法，属于技术分析领域。它可以广泛应用于股票、期货和外汇等所有现代金融市场的分析中，许多投资者使用它来评估买入或卖出时机。

RSI通过计算一定时间内价格变动的平均增长和平均下跌来确定价格的强弱。通常使用的时间周期是14天。RSI的计算基于以下步骤：

计算每个价格周期的价格增长或下跌值。
* 将所有的价格增长值求和并求平均值，再将所有的价格下跌值求和并求平均值。
* 通过将平均价格增长值除以（平均价格增长值 + 平均价格下跌值）乘以100，得到RSI值。
* RSI的取值范围在0到100之间。一般来说，RSI超过70被视为超买信号，暗示价格可能过高，可能会发生回调。相反，RSI低于30被视为超卖信号，暗示价格可能过低，可能会发生反弹。

需要注意的是，RSI是一种趋势跟踪指标，它可以提供关于价格的强弱信息，但并不能独立预测价格的未来走势。在使用RSI时，通常需要结合其他技术指标和图表模式进行综合分析，以做出更准确的决策。


## RSI的计算公式(一)

1. 计算每个价格周期的价格增长或下跌值（通常使用收盘价进行计算）：

   - 如果当前周期的收盘价高于前一个周期的收盘价，则价格增长值为当前收盘价减去前一个周期的收盘价。
   - 如果当前周期的收盘价低于前一个周期的收盘价，则价格下跌值为前一个周期的收盘价减去当前收盘价。
   - 如果当前周期的收盘价与前一个周期的收盘价相等，则价格增长值和价格下跌值都为0。

2. 计算一定时间周期内的平均价格增长和平均价格下跌值。一般使用14天作为常见的时间周期。

   - 将过去14个周期的价格增长值求和并除以14，得到平均价格增长值（Average Gain）。
   - 将过去14个周期的价格下跌值求和并除以14，得到平均价格下跌值（Average Loss）。

3. 计算RSI值：

   - RSI = 100 - (100 / (1 + (平均价格增长值 / 平均价格下跌值)))

根据上述公式，通过计算每个周期的价格增长和价格下跌值，并使用平均价格增长和平均价格下跌值来计算RSI值，可以得到一个0到100之间的相对强弱指标，用于衡量价格的超买和超卖情况。

```javascript
function calculateRSI(closePrices, period = 14) {
  const changes = [];
  const gains = [];
  const losses = [];

  // 计算价格变动、价格增长和价格下跌
  for (let i = 1; i < closePrices.length; i++) {
    const change = closePrices[i] - closePrices[i - 1];
    changes.push(change);
    if (change > 0) {
      gains.push(change);
      losses.push(0);
    } else {
      gains.push(0);
      losses.push(Math.abs(change));
    }
  }

  let avgGain = 0;
  let avgLoss = 0;

  // 计算平均价格增长和平均价格下跌
  for (let i = period; i > 0; i--) {
    avgGain += gains[gains.length - i];
    avgLoss += losses[losses.length - i];
  }

  avgGain /= period;
  avgLoss /= period;

  let rsi = 100 - (100 / (1 + (avgGain / avgLoss)));

  return rsi;
}

```

## RSI的计算公式(二)

RSI值 = [设定周期内的涨幅平均值 ÷ （设定周期内的涨幅平均值 ＋ 设定周期内的跌幅平均值）] × 100

其中，“设定周期”通常是14天，但也可以根据具体情况进行调整。通过计算每个价格周期的涨跌幅，然后对这些数据进行加权平均，就可以得到设定周期内的涨幅平均值和跌幅平均值。利用这些数值，就可以计算出RSI指标的值。

```javascript
function calculateRSI(closePrices: number[], period: number = 14): number {
  const changes: number[] = [];
  const gains: number[] = [];
  const losses: number[] = [];

  // 计算价格变动和柱状图
  for (let i = 1; i < closePrices.length; i++) {
    const change: number = closePrices[i] - closePrices[i - 1];
    changes.push(change);
    if (change > 0) {
      gains.push(change);
      losses.push(0);
    } else {
      gains.push(0);
      losses.push(Math.abs(change));
    }
  }

  let sumOfGains: number = 0;
  let sumOfLosses: number = 0;

  // 计算N根柱内阳柱涨幅之和和N根柱内阴柱跌幅之和
  for (let i = period - 1; i >= 0; i--) {
    sumOfGains += gains[gains.length - 1 - i];
    sumOfLosses += losses[losses.length - 1 - i];
  }

  let rsi: number = (sumOfGains * 100) / (sumOfGains + sumOfLosses);

  return rsi;
}

```


## 总结计算公式

结合以上两种计算方式发现，与binance计算出来的RSI结果有一定的误差，最后在一个github仓库中找到合适的计算方法
* [Indicators](https://github.com/kimboqi/stock-indicators/blob/master/indicator.js)
其中还包含其他技术指标计算方法


```javascript
interface Tick {
  [index: number]: number;
}

interface Result {
  rsi6: number[];
  rsi12: number[];
  rsi24: number[];
  [key: string]: any; // 添加索引签名
}

function calculateRSI(ticks: Tick[]): Result {
  let lastClosePx = ticks[0];
  const days = [6, 12, 24];
  const result: Result = { // 修改此处
    rsi6: [],
    rsi12: [],
    rsi24: []
  };

  for (let i = 0; i < ticks.length; i++) {
    const c = ticks[i];
    const m = Math.max(c - lastClosePx, 0);
    const a = Math.abs(c - lastClosePx);

    for (const d of days) {
      if (!result.hasOwnProperty(`rsi${d}`)) {
        result[`lastSm${d}`] = 0;
        result[`lastSa${d}`] = 0; // 修改此处
        result[`rsi${d}`] = [0];
      } else {
        result[`lastSm${d}`] = (m + (d - 1) * result[`lastSm${d}`]) / d;
        result[`lastSa${d}`] = (a + (d - 1) * result[`lastSa${d}`]) / d;
        if (result[`lastSa${d}`] !== 0) {
          result[`rsi${d}`].push(result[`lastSm${d}`] / result[`lastSa${d}`] * 100);
        } else {
          result[`rsi${d}`].push(0);
        }
      }
    }

    lastClosePx = c;
  }

  return result;
}
```